"0","# Aggregate data to calculate mean values for each disaster type"
"0","disaster_summary <- data_clean %>%"
"0","  group_by(Disaster.Type) %>%"
"0","  summarise("
"0","    Mean_Damage = mean(Total.Damage...000.US.., na.rm = TRUE),"
"0","    Mean_Fatalities = mean(Total.Deaths, na.rm = TRUE),"
"0","    Mean_Affected = mean(Total.Affected, na.rm = TRUE)"
"0","  )"
"0",""
"0","# Improved Bubble Chart"
"0","bubble_chart <- ggplot(disaster_summary, aes("
"0","  x = Mean_Damage, "
"0","  y = Mean_Fatalities, "
"0","  size = Mean_Affected, "
"0","  color = Disaster.Type"
"0",")) +"
"0","  geom_point(alpha = 0.8) +"
"0","  scale_size_continuous(range = c(5, 25)) + # Adjust bubble size range"
"0","  scale_color_brewer(palette = ""Dark2"") + # Improved color palette"
"0","  scale_x_log10(labels = scales::comma) + # Logarithmic scale for x-axis"
"0","  scale_y_log10(labels = scales::comma) + # Logarithmic scale for y-axis"
"0","  theme_minimal() +"
"0","  labs("
"0","    title = ""Comparative Impact of Disaster Types on Humans and Infrastructure"","
"0","    x = ""Mean Predicted Damage ('000 US$, Log Scale)"","
"0","    y = ""Mean Fatalities (Log Scale)"","
"0","    size = ""Mean Affected Population"","
"0","    color = ""Disaster Type"""
"0","  ) +"
"0","  theme("
"0","    legend.position = ""bottom"","
"0","    axis.text.x = element_text(angle = 45, hjust = 1),"
"0","    plot.title = element_text(size = 16, face = ""bold"")"
"0","  ) +"
"0","  geom_text(aes(label = Disaster.Type), size = 3, hjust = -0.2, vjust = 0.5) # Add disaster type labels near points"
"0",""
"0","# Convert to interactive plotly object with enhanced tooltips"
"0","interactive_bubble_chart <- ggplotly(bubble_chart, tooltip = c(""x"", ""y"", ""size"", ""color"")) %>%"
"0","  layout("
"0","    title = list("
"0","      text = ""Comparative Impact of Disaster Types on Humans and Infrastructure"","
"0","      font = list(size = 18)"
"0","    ),"
"0","    xaxis = list("
"0","      title = ""Mean Predicted Damage ('US$, Log Scale)"""
"0","    ),"
"0","    yaxis = list("
"0","      title = ""Mean Fatalities (Log Scale)"""
"0","    )"
"0","  )"
"0",""
"0","# Display the interactive chart"
"0","interactive_bubble_chart"
